"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[567],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>d});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),s=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},m=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),c=s(r),h=n,d=c["".concat(p,".").concat(h)]||c[h]||u[h]||i;return r?a.createElement(d,o(o({ref:t},m),{},{components:r})):a.createElement(d,o({ref:t},m))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=h;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:n,o[1]=l;for(var s=2;s<i;s++)o[s]=r[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}h.displayName="MDXCreateElement"},82933:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=r(87462),n=(r(67294),r(3905));const i={sidebar_position:2},o="Migration from Knit",l={unversionedId:"extras/migrate",id:"extras/migrate",title:"Migration from Knit",description:"Generally, porting your code from Knit to Weaver should be simple, as the API is functionally similar. The only functions that may need to change are Knit.Start() and Knit.OnStart(); since Weaver doesn't use Promises, you may need to implement that yourself, or slightly modify your scripts.",source:"@site/docs/extras/migrate.md",sourceDirName:"extras",slug:"/extras/migrate",permalink:"/Weaver/docs/extras/migrate",draft:!1,editUrl:"https://github.com/paracosm-daemon/weaver/edit/main/docs/extras/migrate.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"defaultSidebar",previous:{title:"Execution Model",permalink:"/Weaver/docs/extras/execution-model"}},p={},s=[{value:"Runners",id:"runners",level:2},{value:"Networking",id:"networking",level:2}],m={toc:s},c="wrapper";function u(e){let{components:t,...r}=e;return(0,n.kt)(c,(0,a.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"migration-from-knit"},"Migration from Knit"),(0,n.kt)("p",null,"Generally, porting your code from Knit to Weaver should be simple, as the API is functionally similar. The only functions that may need to change are ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/Knit/api/KnitServer#Start"},(0,n.kt)("inlineCode",{parentName:"a"},"Knit.Start()"))," and ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/Knit/api/KnitServer#OnStart"},(0,n.kt)("inlineCode",{parentName:"a"},"Knit.OnStart()")),"; since Weaver doesn't use Promises, you may need to implement that yourself, or slightly modify your scripts."),(0,n.kt)("h2",{id:"runners"},"Runners"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-lua"},'local Knit = require(Knit)\n\nKnit.AddServices(script.Runtime)\nKnit.Start():andThen(function(): ()\n    print("Knit has started!")\nend):catch(warn)\n')),(0,n.kt)("p",null,"This is a simple Knit service runner which relies on the use of Promises to handle errors and run code after Knit successfully starts. This behavior can be ported into Weaver in multiple ways. The easiest and most familiar way to port this is by using the ",(0,n.kt)("a",{parentName:"p",href:"https://eryn.io/roblox-lua-promise/"},"Promise")," library by evaera."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-lua"},'local Promise = require(Promise)\nlocal Weaver = require(Weaver)\n\nWeaver.AddServices(script.Runtime)\nPromise.try(Weaver.start):andThen(function(): ()\n    print("Weaver has started!")\nend):catch(warn)\n')),(0,n.kt)("p",null,"If you use the Promise library already, this should be easy to implement in your own code. Otherwise, an easier way is to use ",(0,n.kt)("a",{parentName:"p",href:"https://create.roblox.com/docs/reference/engine/globals/LuaGlobals#xpcall"},(0,n.kt)("inlineCode",{parentName:"a"},"xpcall")),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-lua"},'local Weaver = require(Weaver)\nWeaver.AddServices(script.Runtime)\n-- Since xpcall yields, any code will be ran after this\n-- Think of this as Promise:await()\nxpcall(function(): ()\n    Weaver.Start()\n    print("Weaver has started!")\nend, warn)\n')),(0,n.kt)("p",null,"You can also wrap the ",(0,n.kt)("a",{parentName:"p",href:"https://create.roblox.com/docs/reference/engine/globals/LuaGlobals#xpcall"},(0,n.kt)("inlineCode",{parentName:"a"},"xpcall"))," in a ",(0,n.kt)("a",{parentName:"p",href:"https://create.roblox.com/docs/reference/engine/libraries/task#spawn"},(0,n.kt)("inlineCode",{parentName:"a"},"task.spawn"))," thread to replicate the new thread that Promises spawn, rather than the yielding behavior:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-lua"},'local Weaver = require(Weaver)\nWeaver.AddServices(script.Runtime)\n-- This is functionally the same as Promise.try\ntask.spawn(xpcall, function(): ()\n    Weaver.Start()\n    print("Weaver has started!")\nend, warn)\n')),(0,n.kt)("p",null,"This way of error handling also goes for ",(0,n.kt)("a",{parentName:"p",href:"/api/WeaverServer#OnStart"},(0,n.kt)("inlineCode",{parentName:"a"},"Weaver.OnStart()")),"."),(0,n.kt)("h2",{id:"networking"},"Networking"),(0,n.kt)("p",null,"The equivalent to ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/Knit/api/KnitServer#CreateSignal"},(0,n.kt)("inlineCode",{parentName:"a"},"Knit.CreateSignal()"))," in Weaver is ",(0,n.kt)("a",{parentName:"p",href:"/api/WeaverServer#CreateRemoteSignal"},(0,n.kt)("inlineCode",{parentName:"a"},"WeaverServer.CreateRemoteSignal()")),". They are functionally the same, but named differently. In Studio, or if you use an IDE, using the shortcut ",(0,n.kt)("inlineCode",{parentName:"p"},"CTRL + SHIFT + H"),' should open a "Search and Replace" menu for all scripts in your project. You can easily replace all mentions of ',(0,n.kt)("inlineCode",{parentName:"p"},"CreateSignal")," with ",(0,n.kt)("inlineCode",{parentName:"p"},"CreateRemoteSignal")," this way. Ditto for replacing mentions of Knit with Weaver."),(0,n.kt)("p",null,"The class that was majorly overhauled was ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty"},"RemoteProperty"),". While most of the API is the same, there is no ",(0,n.kt)("inlineCode",{parentName:"p"},"RemoteProperty:Observe()"),", unlike ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/RbxUtil/api/ClientRemoteProperty#Observe"},"Knit's version"),". It was instead replaced with the ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty#Changed"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteProperty.Changed"))," signal, which does not fire when the value for the client has loaded. There is also no substitute to ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/Knit/api/KnitServer#CreateProperty"},(0,n.kt)("inlineCode",{parentName:"a"},"Knit.CreateProperty()")),", rather, any values you set in your ",(0,n.kt)("inlineCode",{parentName:"p"},"Client")," table aside from the remote signal markers will be converted into ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty"},"RemoteProperties"),"."),(0,n.kt)("p",null,"Here's an example of how you would make a ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/RbxUtil/api/RemoteProperty"},"RemoteProperty")," in Knit:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-lua"},'local Service = Knit.CreateService{ Name = "Service" }\nService.Client.RemoteProperty = Knit.CreateProperty(0)\n')),(0,n.kt)("p",null,"In Weaver, the constructor has been changed to this:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-lua"},'local Service = Weaver.CreateService{ Name = "Service" }\nService.Client.RemoteProperty = 0\n')),(0,n.kt)("p",null,"Due to this, you are not able to initialize properties with a value of ",(0,n.kt)("inlineCode",{parentName:"p"},"nil")," in Weaver. This has instead been substituted with the ",(0,n.kt)("a",{parentName:"p",href:"/api/WeaverServer#CreateEmptyProperty"},(0,n.kt)("inlineCode",{parentName:"a"},"WeaverService.CreateEmptyProperty()"))," function:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-lua"},'local Service = Weaver.CreateService{ Name = "Service" }\nService.Client.RemoteProperty = Weaver.CreateEmptyProperty()\n')),(0,n.kt)("p",null,"Generally, the API for ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty"},"RemoteProperties")," is not too different outside of the ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty#Changed"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteProperty.Changed"))," signal. Do note that ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/RbxUtil/api/RemoteProperty#SetTop"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteProperty:SetTop()")),", ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/RbxUtil/api/RemoteProperty#SetForList"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteProperty:SetForList()")),", and ",(0,n.kt)("a",{parentName:"p",href:"https://sleitnick.github.io/RbxUtil/api/RemoteProperty#ClearForList"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteProperty:ClearForList()"))," have been renamed to ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty#SetDefault"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteProperty:SetDefault()")),", ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty#SetForEach"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteProperty:SetForEach()")),", and ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty#ClearForEach"},(0,n.kt)("inlineCode",{parentName:"a"},"RemoteProperty:ClearForEach()"))," respectively. Extra quality-of-life methods have also been added, which you can see in Weaver's ",(0,n.kt)("a",{parentName:"p",href:"/api/RemoteProperty"},"RemoteProperty API reference"),"."))}u.isMDXComponent=!0}}]);